<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnonymousGhost - Social Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .message {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .expiring-soon {
            border-left: 4px solid #f59e0b;
        }
        .expired {
            opacity: 0.6;
            border-left: 4px solid #ef4444;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <header class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl shadow-lg p-6 mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold flex items-center">
                        <i class="fas fa-ghost mr-3"></i>
                        AnonymousGhost
                    </h1>
                    <p class="text-indigo-200 mt-1">Platform sosial anonim dengan pesan sementara</p>
                </div>
                <div class="flex items-center space-x-2 bg-black bg-opacity-20 px-4 py-2 rounded-full">
                    <i class="fas fa-user-secret"></i>
                    <span id="user-id">Anonim-****</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex flex-col md:flex-row gap-6">
            <!-- Post Form -->
            <div class="md:w-1/3">
                <div class="bg-white rounded-xl shadow-md p-6 sticky top-4">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fas fa-pencil-alt mr-2"></i>
                        Kirim Pesan
                    </h2>
                    <form id="post-form">
                        <div class="mb-4">
                            <textarea id="message-content" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent" rows="5" placeholder="Tulis apapun yang ingin Anda sampaikan..."></textarea>
                        </div>
                        <div class="flex items-center mb-4">
                            <input type="checkbox" id="expiry-toggle" checked class="rounded text-indigo-600 focus:ring-indigo-500">
                            <label for="expiry-toggle" class="ml-2 text-sm text-gray-700">Hilang dalam 24 jam</label>
                        </div>
                        <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center justify-center">
                            <i class="fas fa-paper-plane mr-2"></i>
                            Post Anonim
                        </button>
                    </form>
                    
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <h3 class="text-lg font-medium mb-2 flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            Pedoman Komunitas
                        </h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-indigo-500 mr-2 mt-1"></i>
                                <span>Hormati privasi dan identitas semua pengguna</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-indigo-500 mr-2 mt-1"></i>
                                <span>Tidak boleh mengandung konten ilegal atau berbahaya</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-indigo-500 mr-2 mt-1"></i>
                                <span>Pesan akan hilang setelah 24 jam (default)</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Messages Feed -->
            <div class="md:w-2/3">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fas fa-comments mr-2"></i>
                            Pesan Terbaru
                        </h2>
                        <span id="message-count" class="text-sm bg-gray-100 px-3 py-1 rounded-full">0 pesan</span>
                    </div>
                    
                    <div id="messages-container" class="space-y-4">
                        <div class="text-center py-10 text-gray-500">
                            <i class="fas fa-comment-slash text-4xl mb-3 opacity-50"></i>
                            <p>Belum ada pesan</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 text-center text-sm text-gray-500">
            <p>AnonymousGhost - Platform sosial anonim tanpa login</p>
            <p class="mt-1">Semua pesan bersifat sementara dan disimpan secara lokal</p>
        </footer>
    </div>

    <script>
        // Generate random user ID (stored in localStorage)
        const userId = localStorage.getItem('anonymousUserId') || 
                       'Anonim-' + Math.random().toString(36).substr(2, 8);
        localStorage.setItem('anonymousUserId', userId);
        document.getElementById('user-id').textContent = userId;

        // Local storage wrapper
        const messageStorage = {
            getMessages: () => {
                const messages = JSON.parse(localStorage.getItem('anonymousMessages') || '[]');
                // Filter expired messages
                const now = new Date();
                const validMessages = messages.filter(msg => {
                    if (!msg.expiryTime) return true;
                    const expiryDate = new Date(msg.expiryTime);
                    return expiryDate > now;
                });
                
                // Update storage if some messages were expired
                if (validMessages.length !== messages.length) {
                    localStorage.setItem('anonymousMessages', JSON.stringify(validMessages));
                }
                
                return validMessages;
            },
            addMessage: (content, expires) => {
                const messages = messageStorage.getMessages();
                const now = new Date();
                const expiryTime = expires ? new Date(now.getTime() + 24 * 60 * 60 * 1000) : null;
                
                const newMessage = {
                    id: Date.now().toString(),
                    content,
                    timestamp: now.toISOString(),
                    expiryTime: expiryTime ? expiryTime.toISOString() : null,
                    userId: userId
                };
                
                messages.unshift(newMessage);
                localStorage.setItem('anonymousMessages', JSON.stringify(messages));
                return newMessage;
            },
            deleteMessage: (id) => {
                const messages = messageStorage.getMessages();
                const updated = messages.filter(msg => msg.id !== id);
                localStorage.setItem('anonymousMessages', JSON.stringify(updated));
            }
        };

        // Format time
        function formatTime(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        // Format date
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString([], { 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Get time remaining
        function getTimeRemaining(expiryTime) {
            if (!expiryTime) return null;
            
            const now = new Date();
            const expiryDate = new Date(expiryTime);
            const diff = expiryDate - now;
            
            if (diff <= 0) return 'expired';
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            
            return `${hours} jam ${minutes} menit`;
        }

        // Render messages
        function renderMessages() {
            const container = document.getElementById('messages-container');
            const messages = messageStorage.getMessages();
            
            if (messages.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-10 text-gray-500">
                        <i class="fas fa-comment-slash text-4xl mb-3 opacity-50"></i>
                        <p>Belum ada pesan</p>
                    </div>
                `;
                document.getElementById('message-count').textContent = '0 pesan';
                return;
            }
            
            let html = '';
            const now = new Date();
            
            messages.forEach(msg => {
                const expiryStatus = msg.expiryTime ? 
                    (new Date(msg.expiryTime) < now ? 'expired' : 'expiring-soon') : 
                    'permanent';
                
                const timeRemaining = msg.expiryTime ? getTimeRemaining(msg.expiryTime) : 'Permanen';
                const isExpiringSoon = timeRemaining && timeRemaining !== 'expired' && timeRemaining !== 'Permanen' && parseInt(timeRemaining.split(' ')[0]) <= 6;
                
                html += `
                    <div class="message bg-white rounded-lg shadow-sm p-4 ${expiryStatus === 'expired' ? 'expired' : ''} ${isExpiringSoon ? 'expiring-soon' : ''}">
                        <div class="flex justify-between items-start">
                            <p class="flex-1 text-gray-800">${msg.content}</p>
                            <button onclick="deleteMessage('${msg.id}')" class="ml-2 text-gray-400 hover:text-red-500">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                        <div class="mt-3 flex justify-between items-center text-xs text-gray-500">
                            <span>${formatDate(msg.timestamp)}</span>
                            <span class="${expiryStatus === 'expired' ? 'text-red-600' : expiryStatus === 'expiring-soon' ? 'text-yellow-600' : 'text-gray-600'}">
                                ${timeRemaining === 'expired' ? 'EXPIRED' : timeRemaining || 'Permanen'}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            document.getElementById('message-count').textContent = `${messages.length} pesan`;
            
            // Auto-delete expired messages
            messages.forEach(msg => {
                if (msg.expiryTime && new Date(msg.expiryTime) < now) {
                    setTimeout(() => {
                        messageStorage.deleteMessage(msg.id);
                        renderMessages();
                    }, 5000);
                }
            });
        }

        // Delete message
        window.deleteMessage = function(id) {
            messageStorage.deleteMessage(id);
            renderMessages();
        }

        // Handle form submission
        document.getElementById('post-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const content = document.getElementById('message-content').value.trim();
            const expires = document.getElementById('expiry-toggle').checked;
            
            if (!content) return;
            
            messageStorage.addMessage(content, expires);
            document.getElementById('message-content').value = '';
            renderMessages();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderMessages();
            
            // Auto-refresh every minute
            setInterval(renderMessages, 60000);
        });
    </script>
</body>
</html>

